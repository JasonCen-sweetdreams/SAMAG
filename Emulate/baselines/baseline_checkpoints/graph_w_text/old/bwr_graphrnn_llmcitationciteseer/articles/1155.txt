This paper addresses the problem of cooperative task allocation in multi-agent systems, where agents with diverse capabilities need to collaborate to accomplish complex tasks. We propose a distributed constraint optimization framework that enables agents to negotiate and allocate tasks based on their local constraints and preferences. Our approach leverages a novel constraint propagation algorithm that efficiently prunes the search space, reducing the communication overhead and improving the scalability of the system. Experimental results demonstrate the effectiveness of our method in various scenarios, including search and rescue operations and smart grid management.