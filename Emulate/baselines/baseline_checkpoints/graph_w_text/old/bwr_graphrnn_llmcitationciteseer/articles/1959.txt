Distributed database systems (DDS) have become increasingly popular for handling large-scale data processing tasks. However, query optimization in DDS remains a challenging task due to the complexity of optimizing queries across multiple nodes. This paper proposes a novel hierarchical query optimization framework, HQO, which leverages a combination of machine learning and graph-based techniques to optimize query plans. HQO first decomposes the query into sub-queries and assigns them to suitable nodes based on data locality and node availability. It then employs a reinforcement learning-based approach to optimize the query plan at each node. Experimental results on a real-world distributed database system show that HQO achieves an average of 30% reduction in query execution time compared to existing query optimization techniques.