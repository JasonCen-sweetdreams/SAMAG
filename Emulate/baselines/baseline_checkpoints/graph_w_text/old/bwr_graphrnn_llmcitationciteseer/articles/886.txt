Main-memory databases have become increasingly popular due to their ability to provide high performance and low latency. However, achieving high concurrency and consistency in these systems remains a challenging task. This paper proposes a novel query processing optimization framework for multi-version concurrency control (MVCC) in main-memory databases. Our approach leverages a combination of dynamic indexing and version pruning to reduce the overhead of MVCC and improve query performance. Experimental results on a real-world benchmark show that our approach outperforms existing MVCC algorithms by up to 30% in terms of query throughput.