E-commerce search engines often struggle to provide diverse search results, leading to a poor user experience. This paper proposes a novel hierarchical query expansion (HQE) approach that leverages product category hierarchies to generate more diverse and relevant search results. HQE first identifies the most relevant product categories and then expands the query using category-specific keywords. Experimental results on a large-scale e-commerce dataset show that HQE outperforms state-of-the-art query expansion techniques, improving search result diversity by 25% and user satisfaction by 18%. We also demonstrate the effectiveness of HQE in reducing long-tail product visibility issues.