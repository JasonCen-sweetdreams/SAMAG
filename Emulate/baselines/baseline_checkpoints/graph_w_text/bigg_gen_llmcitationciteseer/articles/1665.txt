In multi-agent systems, efficient task allocation is crucial for achieving global objectives. This paper presents a novel hierarchical task allocation framework, 'HTDA', that handles dynamic task dependences and resource constraints. HTDA combines a decentralized task decomposition approach with a centralized constraint optimization mechanism, enabling agents to adapt to changing task relationships and resource availability. Experimental results on a logistics scenario demonstrate that HTDA outperforms existing methods in terms of task completion rate, resource utilization, and system flexibility.