Autonomous agents operating in dynamic environments face the challenge of adapting to changing circumstances while pursuing their goals. This paper presents a novel task planning framework, 'DynaPlan', which integrates goal-oriented planning with online learning to enable agents to respond effectively to environment changes. DynaPlan utilizes a probabilistic graphical model to represent the agent's beliefs about the environment and updates its planning policy through reinforcement learning. Experimental results demonstrate that DynaPlan outperforms existing planning approaches in complex, dynamic scenarios, such as search-and-rescue operations and autonomous driving.