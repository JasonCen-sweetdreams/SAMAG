Multi-agent systems have been increasingly adopted in various applications, including search and rescue, surveillance, and environmental monitoring. However, task allocation and scheduling for heterogeneous agent teams remain a challenging problem. This paper proposes a novel distributed algorithm, 'HATAS', which leverages graph theory and constraint programming to efficiently allocate tasks to agents with diverse capabilities and resource constraints. Our experiments demonstrate that HATAS outperforms existing methods in terms of task completion rate, latency, and robustness to agent failures. We also provide a thorough analysis of the algorithm's complexity and scalability.