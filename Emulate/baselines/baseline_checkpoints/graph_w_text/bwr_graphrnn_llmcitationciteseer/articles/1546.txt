In-memory column-oriented databases have gained popularity for their high performance in analytical workloads. However, query optimization remains a crucial challenge, particularly for complex queries involving joins and aggregations. This paper presents a novel query optimization framework, 'ColOpt', which leverages probabilistic modeling and machine learning to predict optimal query plans. ColOpt integrates a cost-based optimizer with a learned index structure, enabling efficient exploration of the query plan space. Experimental results on a real-world dataset demonstrate that ColOpt outperforms state-of-the-art query optimizers, achieving an average speedup of 3.2x on complex queries.