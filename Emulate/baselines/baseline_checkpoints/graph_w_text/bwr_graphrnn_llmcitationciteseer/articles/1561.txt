As data volumes continue to grow, real-time analytics has become a critical component of modern data-driven applications. However, optimizing queries for distributed databases remains a significant challenge. This paper presents a novel query optimization framework, 'OptiStream', which leverages machine learning and graph-based techniques to minimize query latency and resource utilization. We demonstrate the effectiveness of OptiStream through extensive experiments on a real-world IoT dataset, showcasing improvements of up to 3x in query response time and 2x in resource efficiency compared to state-of-the-art optimization methods.