Distributed database systems have become increasingly popular due to their ability to handle large-scale data and provide high availability. However, query optimization in such systems remains a significant challenge. This paper proposes a novel query optimization technique, 'Distributed Query Rewriter' (DQR), which leverages machine learning and graph-based methods to optimize query plans in real-time. Our approach uses a hybrid cost model that incorporates both statistical and machine learning-based cost estimation techniques to accurately predict query execution times. Experimental results on a distributed database system show that DQR outperforms state-of-the-art query optimizers by up to 30% in terms of query execution time and resource utilization.