Distributed main-memory databases have emerged as a promising solution for high-performance query execution. However, the complexity of query optimization in these systems has become a major bottleneck. This paper presents 'MemOpt', a novel query optimization framework that leverages machine learning and statistical models to efficiently explore the vast space of possible query plans. MemOpt uses a hierarchical reinforcement learning approach to adapt to changing workloads and optimize query performance. Experimental results on a 128-node cluster demonstrate that MemOpt outperforms state-of-the-art optimizers by up to 3x in terms of query latency and 2x in terms of resource utilization.