In multi-agent systems, efficient task allocation is crucial for achieving collective goals. However, existing methods often struggle with scalability and flexibility in dynamic environments. This paper presents a novel hierarchical graph attention network (HGAT) framework, which leverages local and global graph attention mechanisms to allocate tasks to agents. HGAT learns to prioritize tasks based on agent capabilities, task dependencies, and environmental constraints, and adaptively adjusts allocation strategies as the system evolves. Experiments on a range of multi-agent scenarios demonstrate that HGAT outperforms state-of-the-art methods in terms of task completion rate, agent utilization, and adaptability to changing conditions.