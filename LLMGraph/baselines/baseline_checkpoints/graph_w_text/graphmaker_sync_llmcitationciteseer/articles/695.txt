Personalized search engines strive to provide users with relevant results, but often compromise on diversity. This paper proposes a novel ranking-based diversification approach, dubbed 'DivRank', which integrates a probabilistic graphical model with a learning-to-rank framework. DivRank incorporates user behavior, query intent, and document semantics to generate diverse search result lists that balance relevance and novelty. Experimental evaluation on a large-scale query log and a commercial search engine dataset demonstrates significant improvements in user satisfaction, engagement, and diversity metrics compared to state-of-the-art baselines.