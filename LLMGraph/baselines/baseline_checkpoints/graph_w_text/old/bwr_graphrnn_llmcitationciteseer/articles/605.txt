This paper presents a novel decentralized task allocation algorithm for heterogeneous multi-agent systems with time-varying graphs. Our approach leverages distributed optimization techniques and adaptively adjusts to changes in the communication graph. We provide theoretical guarantees for convergence and a thorough evaluation on a realistic scenario, demonstrating improved performance and robustness compared to existing methods. The proposed algorithm enables efficient and scalable task allocation in various applications, such as disaster response, surveillance, and smart cities.