The proliferation of IoT devices has led to an exponential growth in sensor data, necessitating efficient query optimization techniques for real-time analytics. This paper proposes a novel query optimization framework, 'StreamOpt', which leverages both statistical and machine learning-based approaches to minimize latency and maximize throughput. We introduce a novel index structure, 'SensorTree', that adaptively partitions the data stream based on query patterns and data distribution. Experimental results on a large-scale IoT dataset demonstrate that StreamOpt outperforms existing query optimization techniques by up to 3x in terms of query response time and 2x in terms of resource utilization.