In dynamic multi-agent systems, trust plays a crucial role in task allocation and decision-making. This paper proposes an adaptive trust mechanism, 'TrustFlex', which enables agents to quantify and adjust their trust levels in real-time based on observed behavior and reputational cues. We integrate TrustFlex with a distributed constraint optimization framework to allocate tasks efficiently and effectively. Experimental results using a simulated smart factory scenario demonstrate that our approach outperforms existing trust-based methods in terms of task completion rate and overall system resilience.