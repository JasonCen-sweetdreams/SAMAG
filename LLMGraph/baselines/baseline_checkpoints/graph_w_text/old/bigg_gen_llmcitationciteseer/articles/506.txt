Real-time data warehousing has become essential for various applications, including IoT, finance, and healthcare. However, query optimization remains a significant challenge, especially when dealing with massive amounts of data. This paper presents a novel query optimization framework, 'ColumnOpt', which leverages the benefits of column stores for efficient data processing. We introduce a cost-based optimization algorithm that considers both storage and query patterns, enabling real-time query processing and reducing response times by up to 75%. Experimental results on a large-scale IoT dataset demonstrate the efficacy of ColumnOpt in improving query performance and reducing resource utilization.