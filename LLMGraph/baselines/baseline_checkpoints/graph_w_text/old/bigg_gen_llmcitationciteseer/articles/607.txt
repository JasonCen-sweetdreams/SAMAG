Distributed database systems have become increasingly prevalent in modern data management, but optimizing queries in these systems remains a challenging problem. This paper proposes a novel approach to query optimization using graph-based models, which captures the complex dependencies between subqueries and data distribution. We introduce a hierarchical graph representation that enables efficient estimation of query costs and develop a dynamic programming algorithm to find the optimal query plan. Experimental results on a real-world dataset demonstrate significant improvements in query performance and scalability compared to traditional optimization techniques.